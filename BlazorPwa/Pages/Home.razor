@page "/"
@using BlazorPwa.Models
@using BlazorPwa.Services
@inject StudyService StudyService
@inject NavigationManager NavManager

<div class="quiz-container">
    <header class="header">
        <h1>Quiz</h1>
        <p class="subtitle">Choisis une matière pour réviser</p>
    </header>

    <div class="subject-grid">
        @foreach (var subject in Subjects)
        {
            <div class="subject-card" style="--subject-color: @subject.Color" @onclick="() => StartSession(subject.Id)">
                <div class="icon">@subject.Icon</div>
                <div class="name">@subject.Name</div>
                <div class="count">@StudyService.GetFlashcards(subject.Id).Count cartes</div>
            </div>
        }
    </div>
</div>

@code {
    private List<Subject> Subjects = new();

    protected override void OnInitialized()
    {
        Subjects = StudyService.GetSubjects();
    }

    private void StartSession(Guid subjectId)
    {
        NavManager.NavigateTo($"/quiz/{subjectId}");
    }
}

<style>
    .header {
        margin-bottom: 2rem;
    }
    .subtitle {
        color: var(--color-text-muted);
        font-size: 0.9rem;
    }
    .subject-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 1rem;
    }
    .subject-card {
        background: white;
        border-radius: var(--radius-lg);
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        box-shadow: var(--shadow-sm);
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        border: 2px solid transparent;
    }
    .subject-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
        border-color: var(--subject-color);
    }
    .subject-card .icon {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
    }
    .subject-card .name {
        font-weight: 600;
        color: var(--color-primary-dark);
        text-align: center;
    }
    .subject-card .count {
        font-size: 0.75rem;
        color: var(--color-text-muted);
        background: var(--color-background);
        padding: 0.2rem 0.6rem;
        border-radius: var(--radius-full);
    }
</style>
